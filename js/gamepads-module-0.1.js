export default function(t,g){const u=8;const m=28;const p=.04;globalThis.addEventListener(`gamepadconnected`,()=>{});t.env.getGamepads=n=>{const t=navigator.getGamepads();const e=g?g.memory:wasm_memory;const a=new Float32Array(e.buffer);const o=new Uint32Array(e.buffer);const s=new Uint8Array(e.buffer);for(const[r,c]of t.slice(0,u).entries()){let t=n+m*r+1;if(!c||!c.connected||c.mapping!=="standard"){s[t]=0;continue}s[t++]=1;s[t++]=c.buttons.length;s[t++]=c.axes.length;let e=0;for(const[i,f]of c.buttons.entries()){if(i<17&&f.pressed)e|=1<<i}o[t/4]=e;t+=4;for(const[i,d]of c.axes.slice(0,4).entries()){const l=i===1||i===3?-1:1;a[t/4]=Math.abs(d)<p?0:l*(d-Math.sign(d)*p)/(1-p);t+=4}}};t.env.playEffect=(e,t,n,a,o)=>{const s=navigator.getGamepads().find(t=>t?.index===e);s?.vibrationActuator?.playEffect("dual-rumble",{duration:t,startDelay:n,strongMagnitude:a,weakMagnitude:o})}}
